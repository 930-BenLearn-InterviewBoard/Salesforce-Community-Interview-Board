<aura:component  controller="responseController" implements="forceCommunity:availableForAllPageTypes" >
    
    <aura:attribute name="get_question_id" type="String" default="Q-000001"/>
    <aura:handler event="c:ResponseQuestionEvent" action="{!c.getQuestionFromEvent}" />
    
    <aura:attribute name="question" type="String" />
    <aura:attribute name="isLocked" type="boolean" />
     <aura:attribute name="body" type="String" />
    <aura:attribute name="previousVotes" type="Question_Response_Rating__c[]" />
    <aura:attribute name="responses" type="Question_Response__c[]" />
    <aura:handler name="init" value="{!this}" action="{!c.init}"/>
    <div class="slds-align_absolute-center">
    <div class="slds-size_5-of-12">
        <div class="slds-align_absolute-center">
        <div class="questionCard">
        <lightning:card > 
            
            <div class="slds-text-heading_medium">
                <div class= "slds-align_absolute-center">
                {!v.question}
            
                    </div>
          
                </div>
             
            
    <!-- Submission Form -->
     <div class="submission">   
    <div class="slds-align_absolute-center ">
        <fieldset class="slds-box slds-theme_default slds-size_small">
        <legend id="newSubmissionForm" class="slds-text-heading_medium
          slds-p-vertical_small">
          Submit a response
        </legend>
        <form class="slds-form_stacked">
            <lightning:textarea aura:id="subBody" label="Your response:"
                             name="body"
                             type="String"
                             disabled="{!v.isLocked}"
                             onchange="{!c.textChanged}"
                             placeholder = "{!v.isLocked ? 'This question is locked' : 'Type your response here..'}"/>
            
			<aura:if isTrue="{! !v.isLocked}">
            <lightning:button label="Submit"
                              class="slds-m-top_medium"
                              variant="brand"
                              onclick="{!c.createResponse}"/>
                </aura:if>
        </form>
      </fieldset>
    
    </div>

         </div>
    
            </lightning:card>
              </div>
        </div>
       </div>
    </div>
     <div class="slds-align_absolute-center ">
         <div class="slds-size_6-of-12">
    <aura:iteration var="g" items="{!v.responses}" >
       
        <lightning:card class = "responseCard" >
            <div class="Body">
                <p>{!g.Body__c}</p>
                <br></br>
                <p><b>Written by: </b> {!g.CreatedBy.Name}</p>
                <div class="rating slds-grid slds-size_3-of-12 slds-col_bump-left">
                    <div class="slds-grid">
                        <div class="slds-col slds-m-top_small slds-m-left_small slds-m-right_xx-small">
                            <lightning:buttonIconStateful class="{!g.Name}" size="small" iconName="utility:like" selected="{! g.liked }" onclick="{! c.handleLikeButtonClick }" alternativeText="Like" />
                        </div>
                        <p class="slds-col">{!g.Upvotes__c}</p>
                    </div>
                    <div class="slds-grid slds-m-left_medium">
                        <div class="slds-col slds-m-top_small slds-m-left_small slds-m-right_xx-small">
                            <lightning:buttonIconStateful class="{!g.Name}" size="small" iconName="utility:dislike" selected="{! g.disliked }" onclick="{! c.handleDislikeButtonClick }" alternativeText="Dislike" />
                        </div>
                        <p class="slds-col">{!g.Total_Votes__c - g.Upvotes__c}</p>
                    </div>
                </div>
            </div>
           
        </lightning:card>
        
    </aura:iteration>
      </div>  
    </div>
	
</aura:component>